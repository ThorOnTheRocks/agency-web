---
import Layout from '../layouts/Layout.astro';
import { Card, Badge, ProjectImage } from '../components/react/common/ui';
import { FadeIn } from '../components/react/common/animations';
import { getAllProjects } from '../services/content';
import type { Project } from '../services/content';

export const prerender = true; // Static for speed

const projects: Project[] = await getAllProjects();
---

<Layout 
  title="Projects - Engineering Portfolio" 
  description="A selection of technical projects focused on scalability, performance, and user experience."
>
  <FadeIn client:visible>
    <header class="mb-16 pt-8">
      <h1 class="text-4xl font-bold tracking-tight mb-4">Selected Work</h1>
      <p class="text-xl text-muted-foreground max-w-2xl">
        I specialize in building type-safe, full-stack applications. 
        Here are a few projects that demonstrate my approach to 
        software architecture and rigorous engineering standards.
      </p>
    </header>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      {projects.length > 0 ? projects.map((project, idx: number) => (
        <FadeIn client:visible delay={idx * 0.1} className="h-full">
          <Card className="group p-0 h-full flex flex-col overflow-hidden border-white/10">
            {/* Image Area */}
            <div class="aspect-video w-full overflow-hidden bg-neutral-900">
              <ProjectImage 
                src={project.data.heroImage} 
                alt={project.data.title} 
              />
            </div>

            {/* Content Area */}
            <div class="p-6 flex flex-col flex-1">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-bold text-xl group-hover:text-blue-400 transition-colors">{project.data.title}</h3>
                <div class="flex gap-3">
                  {project.data.github && (
                    <a href={project.data.github} target="_blank" rel="noopener" class="text-xs font-mono opacity-60 hover:opacity-100 hover:text-white transition-opacity">
                      [SRC]
                    </a>
                  )}
                  {project.data.link && (
                    <a href={project.data.link} target="_blank" rel="noopener" class="text-xs font-mono opacity-60 hover:opacity-100 hover:text-white transition-opacity">
                      [LIVE]
                    </a>
                  )}
                </div>
              </div>
              
              <p class="text-muted-foreground mb-6 flex-1 leading-relaxed">
                {project.data.description}
              </p>

              <div class="flex flex-wrap gap-2 mt-auto pt-4 border-t border-white/5">
                {project.data.tags?.map((tag: string) => (
                  <Badge>{tag}</Badge>
                ))}
              </div>
            </div>
          </Card>
        </FadeIn>
      )) : (
          // Fallback for empty CMS (Placeholders)
          [1, 2, 3, 4].map((_, idx) => (
            <FadeIn client:visible delay={idx * 0.1} className="h-full">
              <Card className="group p-0 h-full flex flex-col overflow-hidden border-white/10">
                <div class="aspect-video w-full overflow-hidden bg-muted/20 flex items-center justify-center border-b border-white/5">
                  <p class="text-muted-foreground font-mono text-sm">[Project Preview {idx + 1}]</p>
                </div>
                <div class="p-6 flex flex-col flex-1">
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-xl group-hover:text-primary transition-colors">Placeholder Project {idx + 1}</h3>
                    <div class="flex gap-3">
                      <span class="text-xs font-mono opacity-60">[SRC]</span>
                      <span class="text-xs font-mono opacity-60">[LIVE]</span>
                    </div>
                  </div>
                  <p class="text-muted-foreground mb-6 flex-1 leading-relaxed">
                    This is a placeholder project description to visualize the layout. It demonstrates how the card handles text content and spacing.
                  </p>
                  <div class="flex flex-wrap gap-2 mt-auto pt-4 border-t border-white/5">
                    <Badge>React</Badge>
                    <Badge>TypeScript</Badge>
                    <Badge>Tailwind</Badge>
                  </div>
                </div>
              </Card>
            </FadeIn>
          ))
      )}
    </div>
  </FadeIn>
</Layout>